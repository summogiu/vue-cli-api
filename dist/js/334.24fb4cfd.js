"use strict";(self["webpackChunkvue_cli_api"]=self["webpackChunkvue_cli_api"]||[]).push([[334],{9284:function(t,e){e.A={data(){return{followProducts:[]}},watch:{"$route.params.category"(){this.followProducts=JSON.parse(localStorage.getItem("followArray"))},"$route.params.productid"(){this.followProducts=JSON.parse(localStorage.getItem("followArray"))}},methods:{addFollow(t){const e=this.followProducts.findIndex((e=>e.id===t.id));-1!==e?this.followProducts.splice(e,1):this.followProducts.unshift(t);try{localStorage.setItem("followArray",JSON.stringify(this.followProducts))}catch(s){console.error("Error saving to localStorage",s)}},isFollowed(t){return this.followProducts.some((e=>e.id===t.id))}},created(){try{this.followProducts=JSON.parse(localStorage.getItem("followArray"))||[]}catch(t){console.error("Error loading from localStorage",t)}}}},4356:function(t,e,s){s.d(e,{A:function(){return C}});var a=s(6768),o=s(5130),i=s(4232);const r={"aria-label":"Page navigation example"},n={class:"pagination justify-content-center page-list"},l={class:""},c=["disabled"],p=["onClick","disabled"],u={class:""},d=["disabled"];function h(t,e,s,h,g,f){return(0,a.uX)(),(0,a.CE)("nav",r,[(0,a.Lk)("ul",n,[(0,a.Lk)("li",l,[(0,a.Lk)("button",{class:"page-np-btn",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=(0,o.D$)((t=>f.changePage(s.pages.current_page-1)),["prevent"])),disabled:!s.pages.has_pre},[(0,a.Lk)("i",{class:(0,i.C4)(["bi bi-arrow-left page-np-i",{"page-disabled":!s.pages.has_pre}])},null,2)],8,c)]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.pages.total_pages,(t=>((0,a.uX)(),(0,a.CE)("li",{class:"page-li",key:t},[(0,a.Lk)("button",{class:(0,i.C4)(["page-btn",{"page-active":s.pages.current_page===t}]),href:"#",onClick:(0,o.D$)((e=>f.changePage(t)),["prevent"]),disabled:s.pages.current_page===t},(0,i.v_)(t),11,p)])))),128)),(0,a.Lk)("li",u,[(0,a.Lk)("button",{class:"page-np-btn",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,o.D$)((t=>f.changePage(s.pages.current_page+1)),["prevent"])),disabled:!s.pages.has_next},[(0,a.Lk)("i",{class:(0,i.C4)(["bi bi-arrow-right page-np-i",{"page-disabled":!s.pages.has_next}])},null,2)],8,d)])])])}var g={props:["pages"],methods:{changePage(t){this.$emit("change-page",t),window.scrollTo(0,0),console.log("前往頁數",t)}}},f=s(1241);const b=(0,f.A)(g,[["render",h]]);var C=b},4334:function(t,e,s){s.r(e),s.d(e,{default:function(){return I}});var a=s(6768),o=s(4232),i=s(5130);const r={class:"product-list-box"},n={class:"filter-select-box"},l=["data-sort","disabled"],c={class:"product-list-ul toRight-1"},p=["onClick"],u=["src"],d={class:"price-box"},h={class:"price"},g={class:"product-btn-box"},f=["onClick","disabled"],b={key:0,class:"spinner-border text-danger spinner-border-sm",role:"status"},C={key:1,class:"bi bi-cart-plus"},m=["onClick"],k={key:0,class:"bi bi-heart"},w={key:1,class:"bi bi-heart-fill follow-plus-btn-isFollow"},P={class:"totle-item-num"};function _(t,e,s,_,v,y){const L=(0,a.g2)("Loading"),x=(0,a.g2)("PaginationComponents");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(L,{active:v.isLoading},null,8,["active"]),(0,a.Lk)("div",r,[(0,a.Lk)("div",n,[(0,a.bo)((0,a.Lk)("select",{class:"filter-select","onUpdate:modelValue":e[0]||(e[0]=t=>v.selectedOption=t)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(v.options,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t.text,"data-sort":t.sort,disabled:"價格排序"===t.text},(0,o.v_)(t.text),9,l)))),128))],512),[[i.u1,v.selectedOption]])]),(0,a.Lk)("ul",c,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(y.showProducts,((e,s)=>((0,a.uX)(),(0,a.CE)("li",{key:e.id,class:(0,o.C4)([0===s?"big-size-li":"",s===y.showProducts.length-1&&y.showProducts.length>9?"big-size-li":""])},[(0,a.Lk)("div",{class:"product-content",onClick:t=>y.openMore(e)},[(0,a.Lk)("img",{src:e.imageUrl,alt:"",class:"thumbnail"},null,8,u),(0,a.Lk)("p",null,(0,o.v_)(e.title),1)],8,p),(0,a.Lk)("div",d,[(0,a.Lk)("p",h,"NT$"+(0,o.v_)(t.$filters.currency(e.price)),1),(0,a.Lk)("div",g,[(0,a.Lk)("button",{class:"cart-plus-btn",onClick:t=>y.addCart(e.id),disabled:this.status.loadingItem===e.id},[this.status.loadingItem===e.id?((0,a.uX)(),(0,a.CE)("div",b)):((0,a.uX)(),(0,a.CE)("i",C))],8,f),(0,a.Lk)("button",{class:"follow-plus-btn",onClick:s=>t.addFollow(e)},[t.isFollowed(e)?((0,a.uX)(),(0,a.CE)("i",w)):((0,a.uX)(),(0,a.CE)("i",k))],8,m)])])],2)))),128))])]),0!==y.showProducts.length?((0,a.uX)(),(0,a.Wv)(x,{key:0,pages:v.pagination,onChangePage:y.getPagination},null,8,["pages","onChangePage"])):(0,a.Q3)("",!0),(0,a.Lk)("p",P,"共"+(0,o.v_)(this.nowProductsTotle)+"項產品",1)])}var v=s(4356),y=s(1600),L=s(9284),x={components:{PaginationComponents:v.A},data(){return{products:[],product:{},searchContent:"",pagination:{current_page:1,has_next:"",has_pre:"",total_pages:0},perpage:10,isLoading:!1,status:{loadingItem:""},options:[{text:"價格排序",sort:""},{text:"由低至高",sort:"up"},{text:"由高至低",sort:"down"}],selectedOption:"價格排序"}},watch:{"$route.params.category"(){this.getProducts()},showProducts(){if(this.searchContent){const t=this.products.filter((t=>t.title.includes(this.searchContent)));this.pagination.total_pages=Math.ceil(t.length/this.perpage)}else this.pagination.total_pages=Math.ceil(this.products.length/this.perpage);this.selectedOption="價格排序"},selectedOption(t){const e=this.options.find((e=>e.text===t));"up"===e.sort?this.products.sort(((t,e)=>t.price-e.price)):"down"===e.sort&&this.products.sort(((t,e)=>e.price-t.price))}},computed:{showProducts(){const t=this.pagination.current_page*this.perpage-this.perpage+1,e=this.pagination.current_page*this.perpage;if(!this.searchContent)return this.products.filter(((s,a)=>a+1>=t&&a+1<=e));if(this.searchContent){const s=this.products.filter((t=>t.title.includes(this.searchContent)));return s.filter(((s,a)=>a+1>=t&&a+1<=e))}return[]},nowProductsTotle(){if(!this.searchContent)return this.products.length;if(this.searchContent){const t=this.products.filter((t=>t.title.includes(this.searchContent)));return t.length}return 0}},mixins:[y.A,L.A],methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/api/giugiu-api/products/all";this.isLoading=!0,this.$http.get(t).then((t=>{if(this.isLoading=!1,t.data.success){if(this.$route.params.category)if("正在關注"===this.$route.params.category)this.products=this.followProducts;else if(t.data.products.some((t=>t.category.includes(this.$route.params.category)))){const e=t.data.products.filter((t=>t.category.includes(this.$route.params.category)));this.products=e}else{const e=t.data.products.filter((t=>t.title.includes(this.$route.params.category)));this.products=e}else this.products=t.data.products;this.getTotlePage(),this.getPagination(),document.title=`${this.$route.params.category}商品列表-In My Light`}})).catch((t=>{console.log(t)}))},getTotlePage(){this.pagination.total_pages=Math.ceil(this.products.length/this.perpage)},getPagination(t=1){this.pagination.current_page=t,this.pagination.has_next=this.pagination.current_page<this.pagination.total_pages,this.pagination.has_pre=this.pagination.current_page>1},openMore(t){this.$emit("openMore",t),this.$emit("addRecentlyViewed",t)},addCart(t){const e="https://vue3-course-api.hexschool.io/api/giugiu-api/cart";this.status.loadingItem=t,this.$http.post(e,{data:{product_id:t,qty:1}}).then((t=>{t.data.success?(this.$emit("getCart"),this.status.loadingItem=""):console.log("加到購物車失敗",t.data.message)})).catch((t=>{console.log("加到購物車失敗",t)}))},searchKey(t){this.getPagination(),this.searchContent=t}},created(){this.getProducts(),this.searchContent=this.$route.query.searchContent},mounted(){y.A.on("search",this.searchKey)}},$=s(1241);const E=(0,$.A)(x,[["render",_]]);var I=E}}]);
//# sourceMappingURL=334.24fb4cfd.js.map